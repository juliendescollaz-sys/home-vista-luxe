; =============================================================================
; Neolia Gateway - Dialplan
; =============================================================================

[globals]

; -----------------------------------------------------------------------------
; Contexte pour les appels depuis l'interphone (Akuvox)
; -----------------------------------------------------------------------------
[from-doors]
; Akuvox appelle un numero d'appartement (401, 402, etc.)
; Route vers le panel correspondant
exten => 401,1,NoOp(Appel interphone vers appartement 401)
 same => n,Dial(PJSIP/panel-401,60)
 same => n,Hangup()

exten => _4XX,1,NoOp(Appel interphone vers appartement ${EXTEN})
 same => n,Dial(PJSIP/panel-${EXTEN},60)
 same => n,Hangup()

; Legacy: appels 8XXX
exten => 8001,1,NoOp(Service ring_apt1 - legacy)
 same => n,Dial(PJSIP/panel-401,30)
 same => n,Hangup()

; -----------------------------------------------------------------------------
; Contexte pour les appels depuis les panels
; -----------------------------------------------------------------------------
[from-panels]
; Permet d'appeler n'importe quel endpoint par son nom
exten => _X.,1,NoOp(Panel appelle ${EXTEN})
 same => n,Dial(PJSIP/${EXTEN},60)
 same => n,Hangup()

; Appeler l'interphone
exten => interphone,1,NoOp(Appel vers interphone)
 same => n,Dial(PJSIP/1000,60)
 same => n,Hangup()

; Appeler le test
exten => test,1,NoOp(Appel vers test)
 same => n,Dial(PJSIP/test,60)
 same => n,Hangup()

; Appeler panel-401
exten => panel-401,1,NoOp(Appel vers panel-401)
 same => n,Dial(PJSIP/panel-401,60)
 same => n,Hangup()

; Echo test (pour tester l'audio)
exten => 600,1,Answer()
 same => n,Echo()
 same => n,Hangup()

; -----------------------------------------------------------------------------
; Services
; -----------------------------------------------------------------------------
[services]
exten => 8001,1,NoOp(Service ring_apt1)
 same => n,Dial(PJSIP/panel-401,30)
 same => n,Hangup()
