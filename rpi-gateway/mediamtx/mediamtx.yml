# =============================================================================
# MediaMTX Configuration pour Neolia Gateway
# =============================================================================
# Convertit le flux RTSP de l'Akuvox en WebRTC (WHEP) pour les panels
# =============================================================================

# Logs
logLevel: info
logDestinations: [stdout]

# API (pour monitoring)
api: yes
apiAddress: :9997

# RTSP Server (recoit le flux Akuvox ou le pull)
rtsp: yes
rtspAddress: :8554
protocols: [udp, tcp]

# WebRTC Server (WHEP pour les panels)
webrtc: yes
webrtcAddress: :8889
webrtcAllowOrigin: '*'
webrtcICEServers2: []
# Ports UDP pour ICE (RTP media)
webrtcICEUDPMuxAddress: :8189
webrtcICETCPMuxAddress: :8189
# IP locale pour les candidats ICE (important en LAN)
webrtcLocalUDPAddress: 192.168.1.115:8189
webrtcLocalTCPAddress: 192.168.1.115:8189

# HLS pour lecture simple sur les navigateurs/WebViews
hls: yes
hlsAddress: :8888
hlsAllowOrigin: '*'
hlsVariant: mpegts
hlsSegmentCount: 3
hlsSegmentDuration: 1s

# Pas de RTMP/SRT (pas necessaire)
rtmp: no
srt: no

# =============================================================================
# Paths (sources video)
# =============================================================================
paths:
  # Flux principal Akuvox E12W
  akuvox:
    # Source RTSP de l'Akuvox
    source: rtsp://admin:Neolia022@192.168.1.51:554/livestream/11
    sourceProtocol: tcp
    sourceOnDemand: yes
    sourceOnDemandStartTimeout: 10s
    sourceOnDemandCloseAfter: 10s

    # Republication
    runOnInit:
    runOnDemand:
    runOnReady:

    # Lecture autorisee
    readUser:
    readPass:

  # Path generique pour d'autres cameras (futur)
  all_others:
    source: publisher
